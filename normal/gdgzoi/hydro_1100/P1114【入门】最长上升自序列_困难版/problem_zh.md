# 题目描述

**<font color="#FF0000">本题和简单版本的位移区别是 $n$ 的范围</font>**

给定一个长度为 $n$ 的数列，求数值严格单调递增的子序列的长度最长是多少。


# 输入格式

第一行包含整数 $n$。

第二行包含 $n$ 个整数 $a_i$，表示完整序列。


# 输出格式

输出一个整数，表示最大长度。

```input1
7
3 1 2 1 8 5 6
```

```output1
4
```

# 提示
**【样例 #1 解释】**
* $[1, 2, 5, 6]$ 是长度为 $4$ 的上升子序列
* 本题的 $n$ 达到 $10^5$，所以需要用 $O(n\cdot log(n))$ 的算法才能通过
* $dp[i]$ 表示长度为 $i + 1$ 的子序列的最大数的最小值
* $dp[]$ 必然是单调上升的（思考下为什么）
* 那么就可以利用二分查找减小时间复杂度

<details>
<summary><font color="#FF0000">请思考后再点击查看提示</font></summary>

</details>

# 数据规模与限制
* $1 \leq n \leq 10^5$
* $-10^9 \leq w_i \leq 10^9$

# 来源
* [acwing_896.最长上升子序列](https://www.acwing.com/problem/content/898/)