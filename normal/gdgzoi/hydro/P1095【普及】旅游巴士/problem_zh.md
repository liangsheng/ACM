# 题目描述

小 Z 打算在国庆假期期间搭乘旅游巴士去一处他向往已久的景点旅游。

旅游景点的地图共有 $n$ 处地点，在这些地点之间连有 $m$ 条道路。其中 $1$ 号地点为景区入口，$n$ 号地点为景区出口。我们把一天当中景区开门营业的时间记为 $0$ 时刻，则从 $0$ 时刻起，每间隔 $k$ 单位时间便有一辆旅游巴士到达景区入口，同时有一辆旅游巴士从景区出口驶离景区。

所有道路均只能 **<font color="#FF0000">单向通行</font>**。对于每条道路，游客步行通过的用时均为恰好 $1$ 单位时间。

小 Z 希望乘坐旅游巴士到达景区入口，并沿着自己选择的任意路径走到景区出口，再乘坐旅游巴士离开，这意味着他到达和离开景区的时间都必须是 **<font color="#FF0000">$k$ 的非负整数倍**。由于节假日客流众多，**小 Z 在旅游巴士离开景区前只想一直沿着景区道路移动，而不想在任何地点（包括景区入口和出口）或者道路上停留</font>**。

出发前，小 Z 忽然得知：景区采取了限制客流的方法，对于每条道路均设置了一个
“开放时间”$a _ i$，游客只有 **<font color="#FF0000">不早于 $a _ i$ 时刻</font>** 才能通过这条道路。

请帮助小 Z 设计一个旅游方案，使得他乘坐旅游巴士离开景区的时间尽量地早。

# 输入格式

输入的第一行包含 3 个正整数 $n, m, k$，表示旅游景点的地点数、道路数，以及旅游巴士的发车间隔。

输入的接下来 $m$ 行，每行包含 3 个非负整数 $u _ i, v _ i, a_ i$，表示第 $i$ 条道路从地点 $u _ i$ 出发，到达地点 $v _ i$，道路的“开放时间”为 $a _ i$。

# 输出格式

输出一行，仅包含一个整数，表示小 Z 最早乘坐旅游巴士离开景区的时刻。如果不存在符合要求的旅游方案，输出 `-1`。

```input1
5 5 3
1 2 0
2 5 1
1 3 0
3 4 3
4 5 1
```

```output1
6
```

# 提示

**【样例 #1 解释】**

小 Z 可以在 $3$ 时刻到达景区入口，沿 $1 \to 3 \to 4 \to 5$ 的顺序走到景区出口，并在 $6$ 时刻离开。

![img](file://旅游巴士.png)

<details>
<summary><font color="#FF0000">请思考后再点击查看提示</font></summary>

* 状态表示：$dp(u, i)$: 在 $\%k=i$ 时刻到达 $u$ 点的最短时间, 我们要求的是 $dp(n, 0)$
* 状态转移：假设从点 $u$ 到点 $v$ 有一条边, 其最早到达时间是 $t$
* 将状态 $dp(u, i)$ 当做图中的点, 将转移当做图中的边, 然后跑最短路
$$
\begin{equation}
dp(u,i) = \left\{
\begin{array}{lr}
dp(v,(i+1)\%k), & i \geq t \\
dp(v,(i+(t-i+k-1)/k*k+1))\%k, & i \lt t
\end{array}
\right.
\end{equation}
$$

</details>

# 数据规模与限制
* $2 \leq n \leq 10 ^ 4$
* $1 \leq m \leq 2 \times 10 ^ 4$
* $1 \leq k \leq 100$
* $1 \leq u _ i, v _ i \leq n$
* $0 \leq a _ i \leq 10 ^ 6$
* **<font color="#FF0000">提交语言请选择 C++17(O2), 执行速度会快很多</font>**

# 来源
* [luogu: P9751 [CSP-J 2023] 旅游巴士](https://www.luogu.com.cn/problem/P9751)